<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, target-densitydpi=medium-dpi, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">

    <title>CourierApp</title>

    <!-- DB -->
    <script src="js/utilities/DB_Utility_.js" type="text/javascript"></script>
    <script src="resources/ForerunnerDB-master/js/dist/fdb-all.js" type="text/javascript"></script>
    <script type="application/javascript" src="db/Models/MigrationModel.js"></script>
    <script type="application/javascript" src="db/Models/UserModel.js"></script>
    <script type="application/javascript" src="db/Models/SettingsModel.js"></script>
    <script type="application/javascript" src="db/Models/DeliveriesModel.js"></script>
    <script type="application/javascript" src="db/Models/PickupModel.js"></script>
    <script type="application/javascript" src="db/Models/Ajax_queueModel.js"></script>
    <script type="application/javascript" src="db/Models/LogModel.js"></script>
    <script type="application/javascript" src="db/Models/PrinterModel.js"></script>
    <script type="application/javascript" src="db/Models/ProcessModel.js"></script>
    <script type="application/javascript" src="db/Models/GpsModel.js"></script>
    <script type="application/javascript" src="db/run_migrations.js"></script>
    <script type="application/javascript" src="db/setup.js"></script>

    <!-- jQuery 3 -->
    <script src="tpl/bower_components/jquery/dist/jquery.min.js"></script>

    <!-- UNDERSCORE JS -->
    <script src="js/underscore-min.js" type="text/javascript"></script>
    <script src="tpl/bower_components/moment/min/moment.min.js"></script>

    <!-- ACCOUNTING_JS -->
    <script src="resources/bower_components/accounting/accounting.min.js" type="text/javascript"></script>

    <!-- BOOTSTRAP-VALIDATOR -->
    <script src="resources/bower_components/bootstrap-validator/dist/validator.min.js" type="text/javascript"></script>

    <!-- Bootstrap 3.3.7 -->
    <link rel="stylesheet" href="tpl/bower_components/bootstrap/dist/css/bootstrap.min.css">
    <script src="tpl/bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="tpl/bower_components/font-awesome/css/font-awesome.min.css">
    <!-- Ionicons -->
    <link rel="stylesheet" href="tpl/bower_components/Ionicons/css/ionicons.min.css">
    <!-- TOASTER_JS -->
    <script src="resources/bower_components/toastr/toastr.min.js" type="text/javascript"></script>
    <link rel="stylesheet" href="resources/bower_components/toastr/toastr.min.css">

    <!-- Theme style -->
    <link rel="stylesheet" href="tpl/dist/css/AdminLTE.min.css">
    <!-- AdminLTE Skins. Choose a skin from the css/skins
         folder instead of downloading all of them to reduce the load. -->
    <link rel="stylesheet" href="tpl/dist/css/skins/skin-blue.min.css">
    <!-- Google Font -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,700,300italic,400italic,600italic">

    <!-- MENU -->
    <link rel="stylesheet" href="css/menu.css">

    <!-- UTILITIES -->
    <link rel="stylesheet" href="css/app.css">

    <!-- UTILITIES -->
    <script src="js/utilities/JqueryUtility_.js" type="text/javascript"></script>
    <script src="js/utilities/MomentUtility_.js" type="text/javascript"></script>
    <script src="js/utilities/PolishedUtility_.js" type="text/javascript"></script>
    <script src="js/utilities/UrlUtility_.js" type="text/javascript"></script>
    <script src="js/utilities/ToastrUtility_.js" type="text/javascript"></script>
    <script src="js/utilities/SecurityUtility_.js" type="text/javascript"></script>
    <script src="js/utilities/AjaxUtility_.js" type="text/javascript"></script>
    <script src="js/utilities/FormUtility_.js" type="text/javascript"></script>
    <script src="js/utilities/AjaxQueue.js" type="text/javascript"></script>

    <!-- APP -->
    <script src="js/app/Haversine.js" type="text/javascript"></script>
    <script src="js/app/Alert_.js" type="text/javascript"></script>
    <script src="js/data/CustomerSettings.js" type="text/javascript"></script>
    <script src="js/app/Settings.js" type="text/javascript"></script>
    <script src="js/app/Check_hardware.js" type="text/javascript"></script>
    <script src="js/app/Operations.js" type="text/javascript"></script>
    <script src="js/app/Login.js" type="text/javascript"></script>
    <script src="js/setup_front.js" type="text/javascript"></script>
    <script src="js/app/PrinterFormats.js" type="text/javascript"></script>
    <script src="js/app/ProcessForeground.js" type="text/javascript"></script>
    <script src="js/app/ProcessBackground.js" type="text/javascript"></script>
    <script src="js/app/Process.js" type="text/javascript"></script>
    <script src="js/app/Gps.js" type="text/javascript"></script>
    <script src="js/app/Notification.js" type="text/javascript"></script>
    <script src="js/app/Event_server.js" type="text/javascript"></script>
    <script src="js/app/Alert_proximity.js" type="text/javascript"></script>
    <script src="js/app/Alert_time.js" type="text/javascript"></script>


    <!-- VUE -->
    <script src="js/vue.min.js" type="text/javascript"></script>

    <style>
        .pickups .pickup:first-child{
            border-top: none;
        }
        .pickups .pickup{
            border-left: none;
            border-right: none;
        }
        .deliveries .delivery:first-child{
            border-top: none;
        }
        .deliveries .delivery{
            border-left: none;
            border-right: none;
        }
        .nav.navbar-nav>li>a{
            font-size: 21px;
            padding-left: 15px;
            padding-right: 15px;
        }
    </style>
    <script src="js/pages/index.js"></script>
</head>
<body class="hold-transition skin-blue sidebar-mini fixed">
<div class="wrapper" id="App">
    <div style="
        position: absolute; top: 0; left: 0; width: 100%; height: 100%;
        background: rgba(255, 255, 255, 0.93); text-align: center;
        font-size: 10em; padding-top: 35vh; z-index: 999999;
    " v-if="!ready">
        <i class="fa fa-circle-o-notch fa-spin fa-fw margin-bottom"></i>
    </div>

    <header class="main-header">
        <!-- Logo -->
        <a href="#" class="logo hidden-xs">
            <!-- mini logo for sidebar mini 50x50 pixels -->
            <span class="logo-mini"><b>C</b>App</span>
            <!-- logo for regular state and mobile devices -->
            <span class="logo-lg"><b>Courier</b>APP</span>
        </a>
        <!-- Header Navbar: style can be found in header.less -->
        <nav class="navbar navbar-static-top">
            <!-- Sidebar toggle button-->
            <a href="#" class="sidebar-toggle" data-toggle="push-menu" role="button">
                <span class="sr-only">Toggle navigation</span>
            </a>

            <div class="navbar-custom-menu">
                <ul class="nav navbar-nav">
                    <!-- Notifications: style can be found in dropdown.less -->
                    <li class="dropdown notifications-menu" :style="ajax_queue_count>0?'background: darkred;':''">
                        <a href="#" id="check_ajax_queue" @click.prevent="check_ajax_queue">
                            <i class="fa fa-history"></i>
                            <span class="label label-warning">{{ ajax_queue_count }}</span>
                        </a>
                    </li>
                    <!-- Notifications: style can be found in dropdown.less -->
                    <li class="dropdown notifications-menu">
                        <a href="#" class="synchronize_data_operations" @click.prevent="synchronize_data_operations">
                            <i class="fa fa-refresh"></i>
                        </a>
                    </li>
                    <!-- Notifications: style can be found in dropdown.less -->
                    <li class="dropdown notifications-menu">
                        <a href="#">
                            <i class="fa fa-truck"></i>
                            <span class="label label-success">{{ operations.pickups.length }}</span>
                        </a>
                    </li>
                    <!-- Tasks: style can be found in dropdown.less -->
                    <li class="dropdown notifications-menu">
                        <a href="#">
                            <i class="fa fa-tags"></i>
                            <span class="label label-danger">{{ operations.deliveries.length }}</span>
                        </a>
                    </li>
                    <!-- User Account: style can be found in dropdown.less -->
                    <li class="dropdown user user-menu">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                            <i class="fa fa-user"></i>
                        </a>
                        <ul class="dropdown-menu">
                            <!-- User image -->
                            <li class="user-header">
                                <img src="images/icon.png" class="img-circle" alt="User Image" style="background: white; border-radius: 22%!important;" >
                                <p>
                                    {{ user.name }}
                                    <small>{{ user.email }}</small>
                                </p>
                            </li>
                            <!-- Menu Footer-->
                            <li class="user-footer">
                                <div class="pull-right">
                                    <a href="#" class="btn btn-default btn-flat logout">Cerrar sesi√≥n</a>
                                </div>
                            </li>
                        </ul>
                    </li>
                    <!-- Control Sidebar Toggle Button -->
                    <li style="display: none">
                        <a href="#" data-toggle="control-sidebar"><i class="fa fa-gears"></i></a>
                    </li>
                </ul>
            </div>
        </nav>
    </header>
    <!-- Left side column. contains the logo and sidebar -->
    <aside class="main-sidebar" style="padding-top: 50px;">
        <!-- sidebar: style can be found in sidebar.less -->
        <section class="sidebar">
            <!-- sidebar menu: : style can be found in sidebar.less -->
            <ul class="sidebar-menu" data-widget="tree">
                <li class="header">Men√∫ principal</li>
                <li class="active">
                    <a href="index.html">
                        <i class="fa fa-dashboard"></i>
                        <span>
                                Inicio
                            </span>
                    </a>
                </li>
                <li>
                    <a href="map.html">
                        <i class="fa fa-globe"></i>
                        <span>
                            Mapa
                        </span>
                    </a>
                </li>
                <li class="header">SISTEMA</li>
                <li>
                    <a href="log.html">
                        <i class="fa fa-file-text"></i>
                        <span> Log </span>
                    </a>
                </li>
                <li :style="ajax_queue_count>0?'background: darkred;':''">
                    <a href="ajax_queues.html">
                        <i class="fa fa-history"></i>
                        <span>Peticiones en cola</span>
                        <span class="pull-right-container">
                            <span class="label label-warning pull-right">{{ ajax_queue_count }}</span>
                        </span>
                    </a>
                </li>
                <li><a href="#" class="logout"><i class="fa fa-sign-out"></i> <span>Cerrar sesi√≥n</span></a></li>
            </ul>
        </section>
        <!-- /.sidebar -->
    </aside>

    <!-- Content Wrapper. Contains page content -->
    <div class="content-wrapper" style="padding-top: 50px">
        <!-- Main content -->
        <section class="content">
            <div class="row">
                <div class="col-sm-12">
                    <div class="form-group">
                        <div class="input-group">
                            <span class="input-group-btn">
                                <button class="btn btn-default" type="button" @click.prvent="set_number_search('')">
                                    <i class="fa fa-times" aria-hidden="true"></i>
                                </button>
                            </span>
                            <input type="text" class="form-control" placeholder="Buscar por n√∫mero..." v-model="number_search">
                            <span class="input-group-btn">
                                <button class="btn btn-default" type="button" id="scan_barcode_to_search">
                                    <i class="fa fa-barcode" aria-hidden="true"></i>
                                </button>
                            </span>
                        </div>
                    </div>
                    <div class="form-group">
                        <select class="form-control" v-model="date_to_filter">
                            <option v-for="date in dates_to_filter" :value="date">{{ date }}</option>
                        </select>
                    </div>
                </div>
                <div class="col-sm-12" style="padding: 0">
                    <div class="nav-tabs-custom">
                        <ul class="nav nav-tabs">
                            <li class="active">
                                <a href="#tab_pickups" data-toggle="tab">
                                    Recolecci√≥nes
                                    <span class="label bg-green">
                                        {{ pickups_in_list }} de {{ operations.pickups.length }}
                                    </span>
                                </a>
                            </li>
                            <li>
                                <a href="#tab_deliveries" data-toggle="tab">
                                    Entregas <span class="label bg-blue">
                                        {{ deliveries_in_list }} de {{ operations.deliveries.length }}
                                    </span>
                                </a>
                            </li>
                        </ul>
                        <div class="tab-content no-padding">
                            <div class="tab-pane active" id="tab_pickups">
                                <div class="list-group pickups">
                                    <a href="#" class="pickup list-group-item"
                                       v-for=" (pickup, index) in pickups_sorted"
                                       @click.prevent="showPickupModal(pickup)" data-picked="1"
                                       v-if="contains(number_search, pickup.number) || contains(number_search, pickup.consignments)"
                                    >
                                        <span class="text-muted pull-right">
                                            <i class="fa fa-clock-o"></i>
                                            {{ pickup.start_time.substr(0, 5) }} - {{ pickup.end_time.substr(0, 5) }}
                                        </span>
                                        <span :class="['label bg-'+Settings.pickup_state[pickup.state_id].class]">
                                            {{ index+1 }}) {{ Settings.pickup_state[pickup.state_id].name }} - {{ pickup.number }}
                                        </span>
                                        <br>
                                        <i class="fa fa-map-marker"></i> <b>Direcci√≥n:</b> {{ pickup.address }}<br>
                                        <span v-if="pickup.long_address != ''">
                                            {{ pickup.long_address }}<br>
                                        </span>
                                        <i class="fa fa-id-badge"></i>
                                        <span v-if="pickup.company!=''"> <b>Empresa:</b> {{ pickup.company }} </span> <b> {{ pickup.doc }}</b><br>
                                        <i class="fa fa-user"></i> <b>Contacto:</b> {{ pickup.contact }}<br>
                                        <i class="fa fa-bars"></i> <b>Gu√≠as:</b> {{ pickup.consignments }}<br>
                                        <div class="text-muted" style="text-align: right">
                                            <i class="fa fa-globe"></i>
                                            {{ current_position | distance_to_pickup(pickup) }}
                                        </div>
                                    </a>
                                </div>
                            </div>
                            <div class="tab-pane" id="tab_deliveries">
                                <div class="list-group deliveries">
                                    <a href="#" class="delivery list-group-item"
                                       v-for="(delivery, index) in deliveries_sorted"
                                       @click.prevent="showDeliveryModal(delivery)" data-picked="1"
                                       v-if="contains(number_search, delivery.number) || contains(number_search, delivery.consignments)"
                                    >
                                        <span class="text-muted pull-right">
                                            <i class="fa fa-clock-o"></i>
                                            {{ delivery.start_time.substr(0, 5) }} - {{ delivery.end_time.substr(0, 5) }}
                                        </span>
                                        <span :class="['label bg-'+Settings.delivery_state[delivery.state_id].class]">
                                            {{ index+1 }}) {{ Settings.delivery_state[delivery.state_id].name }}- {{ delivery.number }}
                                        </span>
                                        <br>
                                        <i class="fa fa-map-marker"></i> <b>Direcci√≥n:</b> {{ delivery.address }}<br>
                                        <span v-if="delivery.long_address != ''">
                                            {{ delivery.long_address }}<br>
                                        </span>
                                        <i class="fa fa-id-badge"></i>
                                        <span v-if="delivery.company!=''"> <b>Empresa:</b> {{ delivery.company }}</span> <b> {{ delivery.doc }}</b><br>
                                        <i class="fa fa-user"></i> <b>Contacto:</b> {{ delivery.contact }}<br>
                                        <i class="fa fa-bars"></i> <b>Gu√≠as:</b> {{ delivery.consignments }}<br>
                                        <div class="text-muted" style="text-align: right">
                                            <i class="fa fa-globe"></i>
                                            {{ current_position | distance_to_delivery(delivery) }}
                                        </div>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="form-group" style="text-align: center">
                        <button class="btn btn-primary" onclick="printText();">
                            <i class="fa fa-print"></i> Impresi√≥n manual
                        </button>
                    </div>

                </div>
            </div>
        </section>
        <!-- /.content -->
    </div>
    <!-- /.content-wrapper -->
    <footer class="main-footer" style="text-align: center;">
        <div class="pull-right hidden-xs">
            <b>Version</b> 1.0.0
        </div>
        <img src="images/savne_net.png" style="height: 30px;"/><br>
        CourierApp, un sistema desarrollado por <a href="http://www.savne.net" target="_blank">www.savne.net</a>
    </footer>




    <!--  MODALS -->
    <!-- MODAL ACTION PICKUP -->
    <div class="modal" id="pickup_action_modal" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">
                        Recolecci√≥n {{ operations.current_pickup.number }}
                        <div v-if="operations.current_pickup.consignments !== null && $.trim(operations.current_pickup.consignments) != ''">
                            Gu√≠a(s): {{ operations.current_pickup.consignments }}
                        </div>
                    </h4>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-xs-12 no-padding">
                            <div class=" col-xs-6" v-if="operations.current_pickup.state_id == 100 || operations.current_pickup.state_id == 50">
                                <button class="btn btn-block btn-flat btn-app bg-green" data-toggle="modal" data-target="#pickup_success_modal">
                                    <i class="fa fa-check-circle"></i> Registrar recolecci√≥n
                                </button>
                            </div>
                            <div class=" col-xs-6" v-if="operations.current_pickup.state_id == 100 || operations.current_pickup.state_id == 50">
                                <button class="btn btn-block btn-flat btn-app bg-red" data-toggle="modal" data-target="#pickup_exception_modal">
                                    <i class="fa fa-ban"></i> Registrar excepci√≥n
                                </button>
                            </div>
                            <div class=" col-xs-6" >
                                <button class="btn btn-block btn-flat btn-app bg-blue"  data-toggle="modal" data-target="#print_pickup_label">
                                    <i class="fa fa-print"></i> Imprimir label
                                </button>
                            </div>
                            <div class=" col-xs-6" >
                                <button class="btn btn-block btn-flat btn-app bg-purple" data-toggle="modal" data-target="#pickup_attach_photo">
                                    <i class="fa fa-camera"></i> Asociar foto
                                </button>
                            </div>
                            <div class=" col-xs-6">
                                <button class="btn btn-block btn-flat btn-app bg-yellow" data-toggle="modal" data-target="#pickup_consignments_modal">
                                    <i class="fa fa-bars"></i> Asociar gu√≠as
                                </button>
                            </div>
                            <div class=" col-xs-6" v-if="operations.current_pickup.state_id != 50">
                                <a class="btn btn-block btn-flat btn-app bg-maroon" :href="'map.html?show_pickup_id='+operations.current_pickup.id">
                                    <i class="fa fa-globe"></i>
                                    Ver en mapa
                                </a>
                            </div>
                            <div class=" col-xs-6" v-if="operations.current_pickup.phone != null">
                                <button class="btn btn-block btn-flat btn-app bg-aqua" onclick="" type="button"
                                        @click.prevent="window.plugins.CallNumber.callNumber(function(){}, function(){}, operations.current_pickup.phone, true)">
                                    <i class="fa fa-phone"></i> Llamar a {{ operations.current_pickup.phone}}
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>
    <!-- MODAL SUCCESS PICKUP -->
    <div class="modal" id="pickup_success_modal" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
            <form>
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title">
                            Recolecci√≥n {{ operations.current_pickup.number }}
                            <div v-if="operations.current_pickup.consignments !== null && $.trim(operations.current_pickup.consignments) != ''">
                                Gu√≠a(s): {{ operations.current_pickup.consignments }}
                            </div>
                        </h4>
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <div class="callout callout-warning" style="text-align: center;">
                                <p>
                                    VALOR: {{ operations.current_pickup.val | formatMoney }}
                                </p>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="callout callout-info">
                                <p>
                                    <b>Observaciones: </b> {{ operations.current_pickup.obs }}<br>
                                    <b>Contenido: </b> {{ operations.current_pickup.content }}
                                </p>
                            </div>
                        </div>
                        <div class="form-group" >
                            <div class="input-group">
                                <div class="input-group-addon">
                                    <i class="fa fa-calendar-o"></i>
                                </div>
                                <input name="fecha" type="date" class="form-control" current_date required placeholder="YYYY-mm-dd" >
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="bootstrap-timepicker">
                                <div class="input-group">
                                    <div class="input-group-addon">
                                        <i class="fa fa-clock-o"></i>
                                    </div>
                                    <input name="hora" type="time" placeholder="HH:mm:ss" class="form-control" current_time required>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="control-label">Persona que atendi√≥:</label>
                            <input type="text" class="form-control" name="persona_que_atendio">
                        </div>
                        <div class="form-group">
                            <label class="control-label">Observaciones:</label>
                            <textarea class="form-control" name="observaciones"></textarea>
                        </div>

                        <div class="form-group" style="text-align: right; margin: 0;">
                            <a href="#" @click.prevent="$('.extra_data').css('display', 'block')">
                                <i class="fa fa-arrow-circle-down" aria-hidden="true"></i> Informaci√≥n adicional
                            </a>
                        </div>
                        <div class="form-group extra_data" hidde>
                            <label class="control-label">Temperatura:</label>
                            <input class="form-control" type="number" step="0.01" name="informacion_adicional[0][value]"  default-value="">
                            <input type="hidden" name="informacion_adicional[0][label]" default-value="Temperatura">
                            <input type="hidden" name="informacion_adicional[0][name]" default-value="temperatura">
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
                        <button type="submit" class="btn btn-success">Registrar recolecci√≥n</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
    <!-- MODAL PRINT PICKUP LABEL -->
    <div class="modal" id="print_pickup_label" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
            <form>
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title">Label para recolecci√≥n {{ operations.current_pickup.number }}</h4>
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <label class="control-label">Impresora:</label>
                            <select class="form-control" v-model="settings_current_printer" required>
                                <option :value="null">Selecciona tu impresora Bluetooth</option>
                                <option v-for="device in bluetooth_devices" :value="device.address">{{ device.name }}</option>
                            </select>
                        </div>
                        <div class="form-group" style="text-align: right">
                            <a href="#" @click.prevent="scanBluetoohtDevices">
                                <i class="fa fa-refresh"></i>
                                Escanear dispositivos Bluetooth
                            </a>
                        </div>
                        <div class="form-group">
                            <label class="control-label">Tipo:</label>
                            <select class="form-control type_print" required>
                                <option value="">Seleccione tipo</option>
                                <option value="ZPL">C√≥digo ZPL</option>
                                <option value="TXT">Texto</option>
                            </select>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
                        <button type="submit" class="btn btn-success">Imprimir label</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
    <!-- MODAL ATTACH PHOTO PICKUP-->
    <div class="modal" id="pickup_attach_photo" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">
                        Recolecci√≥n {{ operations.current_pickup.number }}
                        <div v-if="operations.current_pickup.consignments !== null && $.trim(operations.current_pickup.consignments) != ''">
                            Gu√≠a(s): {{ operations.current_pickup.consignments }}
                        </div>
                    </h4>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="form-group row" style="text-align: center;">
                            <div class="col-xs-12" style="padding-bottom: 20px;">
                                <img class="photo_of_camera" style="max-height: 200px; max-width: 100%;" :src="current_photo">
                            </div>
                            <div class="col-xs-6">
                                <button class="takePhoto btn btn-block btn-primary">
                                    <i class="fa fa-camera"></i>
                                </button>
                            </div>
                            <div class="col-xs-6">
                                <button class="selectPhoto btn btn-block btn-primary">
                                    <i class="fa fa-picture-o"></i>
                                </button>
                            </div>
                        </div>
                        <div class="checkbox" style="text-align: center;">
                            <label>
                                <input type="checkbox" v-model="transmit_photo_only_with_WiFi">
                                Transmitir foto solo con Wifi
                            </label>
                        </div>
                        <div class="form-group">
                            <label class="control-label">Observaciones:</label>
                            <textarea class="form-control" name="observaciones"></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
                    <button type="button" class="submit btn btn-success attach_photo_to_pickup">Transmitir foto</button>
                </div>
            </div>
        </div>
    </div>
    <!-- MODAL EXCEPTION PICKUP -->
    <div class="modal" id="pickup_exception_modal" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <form>
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title">
                            Recolecci√≥n {{ operations.current_pickup.number }}
                            <div v-if="operations.current_pickup.consignments !== null && $.trim(operations.current_pickup.consignments) != ''">
                                Gu√≠a(s): {{ operations.current_pickup.consignments }}
                            </div>
                        </h4>
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <div class="callout callout-info">
                                <p>
                                    <b>Observaciones para recolecci√≥n: </b> {{ operations.current_pickup.obs }}
                                </p>
                            </div>
                        </div>
                        <div class="form-group" >
                            <div class="input-group">
                                <div class="input-group-addon">
                                    <i class="fa fa-calendar-o"></i>
                                </div>
                                <input name="fecha" type="date" class="form-control" current_date required placeholder="YYYY-mm-dd" >
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="bootstrap-timepicker">
                                <div class="input-group">
                                    <div class="input-group-addon">
                                        <i class="fa fa-clock-o"></i>
                                    </div>
                                    <input name="hora" type="time" placeholder="HH:mm:ss" class="form-control" current_time required>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="control-label">Motivo excepci√≥n:</label>
                            <select class="form-control" name="razon_excepcion" required>
                                <option disabled readonly selected value="">Seleccciona motivo</option>
                                <option value="Nadie en casa">Nadie en casa</option>
                                <option value="En vacaciones">En vacaciones</option>
                                <option value="Direcci√≥n errada">Direcci√≥n errada</option>
                                <option value="Otros">Otros</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="control-label">Persona que atendi√≥:</label>
                            <input type="text" class="form-control" name="persona_que_atendio">
                        </div>
                        <div class="form-group">
                            <label class="control-label">Observaciones:</label>
                            <textarea class="form-control" name="observaciones"></textarea>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
                        <button type="submit" class="btn btn-danger">Registrar exepci√≥n</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- MODAL CONSIGNMENTS PICKUP -->
    <div class="modal" id="pickup_consignments_modal" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <form>
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title">
                            Recolecci√≥n {{ operations.current_pickup.number }}
                            <div v-if="operations.current_pickup.consignments !== null && $.trim(operations.current_pickup.consignments) != ''">
                                Gu√≠a(s): {{ operations.current_pickup.consignments }}
                            </div>
                        </h4>
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <div class="callout callout-info">
                                <p>
                                    <b>Observaciones: </b> {{ operations.current_pickup.obs }}
                                </p>
                            </div>
                        </div>
                        <div class="form-group">
                            <button class="btn btn-flat btn-block btn-default scan_barcode_update_consigment" type="button">
                                <i class="fa fa-barcode"></i> Leer c√≥digo de barras
                            </button>
                        </div>
                        <div class="form-group">
                            <label class="control-label">Gu√≠as:</label>
                            <textarea class="form-control" name="guias" rows="6" required></textarea>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
                        <button type="submit" class="btn btn-success">Asociar gu√≠as</button>
                    </div>
                </form>
            </div>
        </div>
    </div>


    <!-- MODAL ACTION DELIVERY -->
    <div class="modal" id="delivery_action_modal" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">
                        Entrega {{ operations.current_delivery.number }}
                        <div v-if="operations.current_delivery.consignments !== null && $.trim(operations.current_delivery.consignments) != ''">
                            Gu√≠a(s): {{ operations.current_delivery.consignments }}
                        </div>
                    </h4>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-xs-12 no-padding">
                            <div class=" col-xs-6" v-if="operations.current_delivery.state_id == 100 || operations.current_delivery.state_id == 50">
                                <button class="btn btn-block btn-flat btn-app bg-green" data-toggle="modal" data-target="#delivery_success_modal">
                                    <i class="fa fa-check-circle"></i> Registrar entrega
                                </button>
                            </div>
                            <div class=" col-xs-6" v-if="operations.current_delivery.state_id  == 100 || operations.current_delivery.state_id == 50">
                                <button class="btn btn-block btn-flat btn-app bg-red" data-toggle="modal" data-target="#delivery_exception_modal">
                                    <i class="fa fa-ban"></i> Registrar excepci√≥n
                                </button>
                            </div>
                            <div class=" col-xs-6">
                                <button class="btn btn-block btn-flat btn-app bg-blue"  data-toggle="modal" data-target="#print_delivery_label">
                                    <i class="fa fa-print"></i> Imprimir label
                                </button>
                            </div>
                            <div class=" col-xs-6">
                                <button class="btn btn-block btn-flat btn-app bg-purple" data-toggle="modal" data-target="#delivery_attach_photo">
                                    <i class="fa fa-camera"></i> Asociar foto
                                </button>
                            </div>
                            <div class=" col-xs-6">
                                <button class="btn btn-block btn-flat btn-app bg-yellow" data-toggle="modal" data-target="#delivery_consignments_modal">
                                    <i class="fa fa-bars"></i> Asociar gu√≠as
                                </button>
                            </div>
                            <div class=" col-xs-6" v-if="operations.current_delivery.state_id != 50">
                                <a class="btn btn-block btn-flat btn-app bg-maroon" :href="'map.html?show_delivery_id='+operations.current_delivery.id">
                                    <i class="fa fa-globe"></i> Ver en mapa
                                </a>
                            </div>
                            <div class=" col-xs-6" v-if="operations.current_delivery.phone != null">
                                <button class="btn btn-block btn-flat btn-app bg-aqua" onclick="" type="button"
                                        @click.prevent="window.plugins.CallNumber.callNumber(function(){}, function(){}, operations.current_delivery.phone, true)">
                                    <i class="fa fa-phone"></i> Llamar a {{ operations.current_delivery.phone}}
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>
    <!-- MODAL PRINT DELIVERY LABEL -->
    <div class="modal" id="print_delivery_label" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
            <form>
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title">Label para entrega {{ operations.current_delivery.number }}</h4>
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <label class="control-label">Impresora:</label>
                            <select class="form-control" v-model="settings_current_printer" required>
                                <option :value="null">Selecciona tu impresora Bluetooth</option>
                                <option v-for="device in bluetooth_devices" :value="device.address">{{ device.name }}</option>
                            </select>
                        </div>
                        <div class="form-group" style="text-align: right">
                            <a href="#" @click.prevent="scanBluetoohtDevices">
                                <i class="fa fa-refresh"></i>
                                Escanear dispositivos Bluetooth
                            </a>
                        </div>
                        <div class="form-group">
                            <label class="control-label">Tipo:</label>
                            <select class="form-control type_print" required>
                                <option value="">Seleccione tipo</option>
                                <option value="ZPL">C√≥digo ZPL</option>
                                <option value="TXT">Texto</option>
                            </select>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
                        <button type="submit" class="btn btn-success">Imprimir label</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
    <!-- MODAL SUCCESS DELIVERY -->
    <div class="modal" id="delivery_success_modal" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
            <form>
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title">
                            Entrega {{ operations.current_delivery.number }}
                            <div v-if="operations.current_delivery.consignments !== null && $.trim(operations.current_delivery.consignments) != ''">
                                Gu√≠a(s): {{ operations.current_delivery.consignments }}
                            </div>
                        </h4>
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <div class="callout callout-warning" style="text-align: center;">
                                <p>
                                    VALOR: {{ operations.current_delivery.val | formatMoney }}
                                </p>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="callout callout-info">
                                <p>
                                    <b>Observaciones: </b> {{ operations.current_delivery.obs }}<br>
                                    <b>Contenido: </b> {{ operations.current_delivery.content }}
                                </p>
                            </div>
                        </div>
                        <div class="form-group" >
                            <div class="input-group">
                                <div class="input-group-addon">
                                    <i class="fa fa-calendar-o"></i>
                                </div>
                                <input name="fecha" type="date" class="form-control" current_date required placeholder="YYYY-mm-dd" >
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="bootstrap-timepicker">
                                <div class="input-group">
                                    <div class="input-group-addon">
                                        <i class="fa fa-clock-o"></i>
                                    </div>
                                    <input name="hora" type="time" placeholder="HH:mm:ss" class="form-control" current_time required>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="control-label">Persona que atendi√≥:</label>
                            <input type="text" class="form-control" name="persona_que_atendio">
                        </div>
                        <div class="form-group">
                            <label class="control-label">Observaciones:</label>
                            <textarea class="form-control" name="observaciones"></textarea>
                        </div>

                        <div class="form-group" style="text-align: right; margin: 0;">
                            <a href="#" @click.prevent="$('.extra_data').css('display', 'block')">
                                <i class="fa fa-arrow-circle-down" aria-hidden="true"></i> Informaci√≥n adicional
                            </a>
                        </div>
                        <div class="form-group extra_data" hidde>
                            <label class="control-label">Temperatura:</label>
                            <input class="form-control" type="number" step="0.01" name="informacion_adicional[0][value]"  default-value="">
                            <input type="hidden" name="informacion_adicional[0][label]" default-value="Temperatura">
                            <input type="hidden" name="informacion_adicional[0][name]" default-value="temperatura">
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
                        <button type="submit" class="btn btn-success">Registrar entrega</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
    <!-- MODAL ATTACH PHOTO DELIVERY-->
    <div class="modal" id="delivery_attach_photo" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">
                        Entrega {{ operations.current_delivery.number }}
                        <div v-if="operations.current_delivery.consignments !== null && $.trim(operations.current_delivery.consignments) != ''">
                            Gu√≠a(s): {{ operations.current_delivery.consignments }}
                        </div>
                    </h4>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="form-group row" style="text-align: center;">
                            <div class="col-xs-12" style="padding-bottom: 20px;">
                                <img class="photo_of_camera" style="max-height: 200px; max-width: 100%;" :src="current_photo">
                            </div>
                            <div class="col-xs-6">
                                <button class="takePhoto btn btn-block btn-primary">
                                    <i class="fa fa-camera"></i>
                                </button>
                            </div>
                            <div class="col-xs-6">
                                <button class="selectPhoto btn btn-block btn-primary">
                                    <i class="fa fa-picture-o"></i>
                                </button>
                            </div>
                        </div>
                        <div class="checkbox" style="text-align: center;">
                            <label>
                                <input type="checkbox" v-model="transmit_photo_only_with_WiFi">
                                Transmitir foto solo con Wifi
                            </label>
                        </div>
                        <div class="form-group">
                            <label class="control-label">Observaciones:</label>
                            <textarea class="form-control" name="observaciones"></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
                    <button type="button" class="submit btn btn-success attach_photo_to_delivery">Transmitir foto</button>
                </div>
            </div>
        </div>
    </div>
    <!-- MODAL EXCEPTION DELIVERY -->
    <div class="modal" id="delivery_exception_modal" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <form>
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title">
                            Entrega {{ operations.current_delivery.number }}
                            <div v-if="operations.current_delivery.consignments !== null && $.trim(operations.current_delivery.consignments) != ''">
                                Gu√≠a(s): {{ operations.current_delivery.consignments }}
                            </div>
                        </h4>
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <div class="callout callout-info">
                                <p>
                                    <b>Observaciones: </b> {{ operations.current_delivery.obs }}
                                </p>
                            </div>
                        </div>
                        <div class="form-group" >
                            <div class="input-group">
                                <div class="input-group-addon">
                                    <i class="fa fa-calendar-o"></i>
                                </div>
                                <input name="fecha" type="date" class="form-control" current_date required placeholder="YYYY-mm-dd" >
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="bootstrap-timepicker">
                                <div class="input-group">
                                    <div class="input-group-addon">
                                        <i class="fa fa-clock-o"></i>
                                    </div>
                                    <input name="hora" type="time" placeholder="HH:mm:ss" class="form-control" current_time required>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="control-label">Motivo excepci√≥n:</label>
                            <select class="form-control" name="razon_excepcion" required>
                                <option disabled readonly selected value="">Seleccciona motivo</option>
                                <option value="Nadie en casa">Nadie en casa</option>
                                <option value="En vacaciones">En vacaciones</option>
                                <option value="Direcci√≥n errada">Direcci√≥n errada</option>
                                <option value="Otros">Otros</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="control-label">Persona que atendi√≥:</label>
                            <input type="text" class="form-control" name="persona_que_atendio">
                        </div>
                        <div class="form-group">
                            <label class="control-label">Observaciones:</label>
                            <textarea class="form-control" name="observaciones"></textarea>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
                        <button type="submit" class="btn btn-danger">Registrar exepci√≥n</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <!-- MODAL CONSIGNMENTS DELIVERY -->
    <div class="modal" id="delivery_consignments_modal" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <form>
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title">
                            Entrega {{ operations.current_delivery.number }}
                            <div v-if="operations.current_delivery.consignments !== null && $.trim(operations.current_delivery.consignments) != ''">
                                Gu√≠a(s): {{ operations.current_delivery.consignments }}
                            </div>
                        </h4>
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <div class="callout callout-info">
                                <p>
                                    <b>Observaciones: </b> {{ operations.current_delivery.obs }}
                                </p>
                            </div>
                        </div>
                        <div class="form-group">
                            <button class="btn btn-flat btn-block btn-default scan_barcode_update_consigment" type="button">
                                <i class="fa fa-barcode"></i> Leer c√≥digo de barras
                            </button>
                        </div>
                        <div class="form-group">
                            <label class="control-label">Gu√≠as:</label>
                            <textarea class="form-control" name="guias" rows="6" required></textarea>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
                        <button type="submit" class="btn btn-success">Asociar gu√≠as</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
<!-- ./wrapper -->




<!-- jQuery UI 1.11.4 -->
<script src="tpl/bower_components/jquery-ui/jquery-ui.min.js"></script>
<!-- Resolve conflict in jQuery UI tooltip with Bootstrap tooltip -->
<script>
    $.widget.bridge('uibutton', $.ui.button);
</script>
<script src="tpl/bower_components/moment/min/moment.min.js"></script>
<!-- Slimscroll -->
<script src="tpl/bower_components/jquery-slimscroll/jquery.slimscroll.min.js"></script>
<!-- FastClick -->
<script src="tpl/bower_components/fastclick/lib/fastclick.js"></script>
<!-- AdminLTE App -->
<script src="tpl/dist/js/adminlte.min.js"></script>
<!-- AdminLTE for demo purposes -->
<script src="tpl/dist/js/demo.js"></script>

<script type="text/javascript" src="cordova.js"></script>
<script src="js/pages/intranet.js" type="text/javascript"></script>

</body>
</html>